---
sidebar: sidebar 
permalink: task_dc_na_7mode.html 
keywords: data collector, 7-mode, NetApp 
summary: NetApp 7 モード データ コレクターを構成します。 
---
= 7-Mode データコレクターで動作するNetApp Data ONTAP
:hardbreaks:
:allow-uri-read: 


[role="lead"]
7-Mode で動作するData ONTAPソフトウェアを使用するストレージ システムの場合は、CLI を使用して容量とパフォーマンス データを取得する 7-Mode データ コレクタを使用します。



== 用語

Data Infrastructure Insights は、 NetApp 7 モード データ コレクターから次のインベントリ情報を取得します。取得した資産の種類ごとに、その資産に使用される最も一般的な用語が表示されます。このデータ コレクターを表示またはトラブルシューティングするときは、次の用語に留意してください。


NOTE: このデータ収集者はlink:task_getting_started_with_cloud_insights.html#useful-definitions["非推奨"]。

[cols="2*"]
|===
| ベンダー/モデル用語 | Data Infrastructure Insights用語 


| ディスク | ディスク 


| レイドグループ | ディスクグループ 


| ファイラー | ストレージ 


| ファイラー | ストレージ ノード 


| Aggregate | ストレージ プール 


| LUN | Volume 


| Volume | 内部容積 
|===
注: これらは一般的な用語のマッピングのみであり、このデータ コレクターのすべてのケースを反映しているわけではありません。



== 要件

このデータ コレクターを構成して使用するには、次のものが必要です。

* FASストレージ コントローラとパートナーの IP アドレス。
* ポート443
* 7-Mode の次のロール機能を持つコントローラおよびパートナー コントローラのカスタム管理者レベルのユーザー名とパスワード:
+
** 「api-*」: これを使用すると、 OnCommand Insight はすべてのNetAppストレージ API コマンドを実行できるようになります。
** 「login-http-admin」: これを使用して、 OnCommand Insight がHTTP 経由でNetAppストレージに接続できるようにします。
** 「security-api-vfiler」: これを使用して、 OnCommand Insight がNetAppストレージ API コマンドを実行して vFiler ユニット情報を取得できるようにします。
** 「cli-options」: これを使用してストレージ システムのオプションを読み取ります。
** 「cli-lun」: LUN を管理するにはこれらのコマンドにアクセスします。指定された LUN または LUN のクラスのステータス (LUN パス、サイズ、オンライン/オフライン状態、共有状態) を表示します。
** 「cli-df」: 空きディスク容量を表示するにはこれを使用します。
** 「cli-ifconfig」: インターフェースと IP アドレスを表示するにはこれを使用します。






== 構成

[cols="2*"]
|===
| フィールド | 説明 


| ストレージシステムのアドレス | NetAppストレージ システムの IP アドレスまたは完全修飾ドメイン名 


| ユーザー名 | NetAppストレージシステムのユーザー名 


| パスワード | NetAppストレージシステムのパスワード 


| クラスタ内のHAパートナーのアドレス | HA パートナーの IP アドレスまたは完全修飾ドメイン名 


| クラスタ内のHAパートナーのユーザー名 | HAパートナーのユーザー名 


| クラスタ内のHAパートナーファイラーのパスワード | HAパートナーのパスワード 
|===


== 高度な設定

[cols="2*"]
|===
| フィールド | 説明 


| インベントリポーリング間隔（分） | インベントリ ポーリングの間隔。デフォルトは20分です。 


| 接続タイプ | HTTPSまたはHTTP、デフォルトのポートも表示します 


| 接続ポートのオーバーライド | 空白の場合は、接続タイプフィールドのデフォルトのポートを使用します。それ以外の場合は、使用する接続ポートを入力します。 


| パフォーマンスポーリング間隔（秒） | パフォーマンス ポーリングの間隔。デフォルトは300秒です。 
|===


== ストレージシステムの接続

このデータ コレクターのデフォルトの管理ユーザーを使用する代わりに、このデータ コレクターがNetAppストレージ システムからデータを取得できるように、 NetAppストレージ システム上で直接管理権限を持つユーザーを構成することもできます。

NetAppストレージ システムに接続するには、メイン pfiler (ストレージ システムが存在する) を取得するときに指定されるユーザーが次の条件を満たしている必要があります。

* ユーザーは vfiler0 (ルート ファイラー/pfiler) 上にいる必要があります。
+
ストレージ システムは、メイン pfiler を取得するときに取得されます。

* 次のコマンドは、ユーザー ロールの機能を定義します。
+
** 「api-*」: これを使用すると、 Data Infrastructure Insights がすべてのNetAppストレージ API コマンドを実行できるようになります。
+
ZAPI を使用するにはこのコマンドが必要です。

** 「login-http-admin」: これを使用して、 Data Infrastructure Insights がHTTP 経由でNetAppストレージに接続できるようにします。  ZAPI を使用するにはこのコマンドが必要です。
** 「security-api-vfiler」: これを使用して、 Data Infrastructure Insights がNetAppストレージ API コマンドを実行して vFiler ユニット情報を取得できるようにします。
** "cli-options": "options" コマンド用で、パートナー IP および有効なライセンスに使用されます。
** 「cli-lun」: LUN を管理するにはこれらのコマンドにアクセスします。指定された LUN または LUN のクラスのステータス (LUN パス、サイズ、オンライン/オフライン状態、共有状態) を表示します。
** 「cli-df」: 「df -s」、「df -r」、「df -A -r」コマンドで空き領域を表示するために使用されます。
** 「cli-ifconfig」: 「ifconfig -a」コマンド用で、ファイラー IP アドレスを取得するために使用されます。
** "cli-rdfile": "rdfile /etc/netgroup" コマンド用で、ネットグループを取得するために使用されます。
** 「cli-date」: 「date」コマンド用で、スナップショット コピーを取得するための完全な日付を取得するために使用されます。
** 「cli-snap」: 「snap list」コマンド用で、スナップショット コピーを取得するために使用されます。




cli-date または cli-snap 権限が付与されていない場合、取得は完了しますが、スナップショット コピーは報告されません。

7-Mode データ ソースを正常に取得し、ストレージ システムで警告が生成されないようにするには、次のコマンド文字列のいずれかを使用してユーザー ロールを定義する必要があります。ここにリストされている 2 番目の文字列は、最初の文字列の簡素化されたバージョンです。

* ログイン-http-admin、api-*、セキュリティ-api-vfile、cli-rdfile、cli-options、cli-df、cli-lun、cli-ifconfig、cli-date、cli-snap、_
* login-http-admin、api-*、security-api-vfile、cli-




== トラブルシューティング

このデータ コレクターで問題が発生した場合に試すことができるいくつかのこと:



=== インベントリ

[cols="2*"]
|===
| 問題： | これを試してください: 


| 401 HTTP 応答または 13003 ZAPI エラー コードを受信し、ZAPI が「権限が不十分です」または「このコマンドは許可されていません」を返します。 | ユーザー名とパスワード、およびユーザー権限/許可を確認します。 


| 「コマンドの実行に失敗しました」というエラー | ユーザーがデバイスに対して以下の権限を持っているかどうかを確認します: • api-* • cli-date • cli-df • cli-ifconfig • cli-lun • cli-operations • cli-rdfile • cli-snap • login-http-admin • security-api-vfiler また、 ONTAPのバージョンがData Infrastructure Insightsでサポートされているかどうかを確認し、使用されている資格情報がデバイスの資格情報と一致しているかどうかを確認します。 


| クラスタバージョンは 8.1 未満です | クラスターの最小サポートバージョンは 8.1 です。サポートされている最小バージョンにアップグレードします。 


| ZAPI は「クラスタ ロールが cluster_mgmt LIF ではありません」を返します | AU はクラスター管理 IP と通信する必要があります。  IPを確認し、必要に応じて別のIPに変更します 


| エラー:「7 モード ファイラーはサポートされていません」 | このデータ コレクターを使用して 7 モード ファイラーを検出すると、この問題が発生する可能性があります。代わりに、IP を変更して cdot ファイラーを指すようにします。 


| 再試行後にZAPIコマンドが失敗する | AU はクラスターとの通信に問題があります。ネットワーク、ポート番号、IP アドレスを確認します。ユーザーは、AU マシンのコマンド ラインからコマンドを実行することも試みる必要があります。 


| AUはZAPIへの接続に失敗しました | IP/ポート接続を確認し、ZAPI 構成を確認します。 


| AUはHTTP経由でZAPIに接続できませんでした | ZAPI ポートがプレーンテキストを受け入れるかどうかを確認します。  AU が SSL ソケットにプレーンテキストを送信しようとすると、通信は失敗します。 


| SSLException により通信が失敗しました | AU は、ファイラー上のプレーンテキスト ポートに SSL を送信しようとしています。  ZAPI ポートが SSL を受け入れるかどうかを確認するか、別のポートを使用します。 


| 追加の接続エラー: ZAPI 応答にエラー コード 13001、「データベースが開いていません」が含まれています。ZAPI エラー コードは 60 で、応答には「API が時間どおりに終了しませんでした」が含まれています。ZAPI 応答には「initialize_session() が NULL 環境を返しました」が含まれています。ZAPI エラー コードは 14007 で、応答には「ノードが正常ではありません」が含まれています。 | ネットワーク、ポート番号、IP アドレスを確認します。ユーザーは、AU マシンのコマンド ラインからコマンドを実行することも試みる必要があります。 


| ZAPI のソケットタイムアウトエラー | ファイラーの接続を確認し、タイムアウトを増やしてください。 


| 「Cモードクラスタは7モードデータソースではサポートされていません」というエラー | IP を確認し、IP を 7 Mode クラスターに変更します。 


| 「vFilerへの接続に失敗しました」エラー | 取得するユーザーの機能に少なくとも以下が含まれていることを確認します: api-* security-api-vfiler login-http-admin ファイラーが少なくとも ONTAPI バージョン 1.7 を実行していることを確認します。 
|===
追加情報は以下からご覧いただけます。link:concept_requesting_support.html["サポート"]ページまたはlink:reference_data_collector_support_matrix.html["データコレクターサポートマトリックス"]。
