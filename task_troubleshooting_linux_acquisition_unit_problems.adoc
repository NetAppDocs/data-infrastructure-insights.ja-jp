---
sidebar: sidebar 
permalink: task_troubleshooting_linux_acquisition_unit_problems.html 
summary: 取得ユニットの問題に関するトラブルシューティングのヒント。 
keywords: AU, acquisition unit, trioubleshooting 
---
= Linux での取得ユニットの問題のトラブルシューティング
:hardbreaks:
:allow-uri-read: 


[role="lead"]
ここでは、Linux サーバー上の Acquisition Units に関する問題のトラブルシューティングに関する提案を紹介します。

|===


| *問題：* | *これを試してみてください:* 


| *Observability > Collectors* ページの *Acquisition Units* タブの AU ステータスに、「証明書の有効期限が切れました」または「証明書が取り消されました」と表示されます。 | AU の右側にあるメニューをクリックし、*接続の復元*を選択します。取得ユニットを復元するには、次の手順に従ってください。1.  Acquisition Unit (AU) サービスを停止します。 [停止コマンドのコピー] ボタンをクリックすると、コマンドをクリップボードにすばやくコピーし、このコマンドを取得ユニット マシンのコマンド プロンプトに貼り付けることができます。2. AU の _/var/lib/netapp/cloudinsights/acq/conf_ フォルダーに「token」という名前のファイルを作成します。3. [トークンをコピー] ボタンをクリックし、このトークンを作成したファイルに貼り付けます。4.AUサービスを再開します。  [_再起動コマンドのコピー_] ボタンをクリックし、コマンドを AU のコマンド プロンプトに貼り付けます。 


| 取得ユニット サーバー サービスの起動時にアクセスが拒否されました | AU を SELINUX にインストールする場合、SE を _permissive_ モードに設定する必要があります。  _Enforcing_ モードはサポートされていません。  SELINUX を許可モードに設定した後、AU サービスを再起動します。 


| サーバー要件が満たされていません | 取得ユニットサーバーまたはVMが以下の要件を満たしていることを確認してください。link:concept_acquisition_unit_requirements.html["要件"] 


| ネットワーク要件が満たされていません | Acquisition Unit サーバー/VM がポート 443 経由の SSL 接続を介してData Infrastructure Insights環境 (<environment-name>.c01.cloudinsights.netapp.com) にアクセスできることを確認します。次のコマンドを試してください: _ping <environment-name>.c01.cloudinsights.netapp.com_ _traceroute <environment-name>.c01.cloudinsights.netapp.com_ _curl \https://<environment-name>.c01.cloudinsights.netapp.com_ _wget \https://<environment-name>.c01.cloudinsights.netapp.com_ AU からData Infrastructure Insightsへの「アウトバウンド」でポート 443 を開く必要があることに注意してください。 


| プロキシサーバーが正しく構成されていません | プロキシ設定を確認し、正しいプロキシ設定を入力するために、必要に応じて Acquisition Unit ソフトウェアをアンインストールして再インストールしてください。1. 「curl」を試してください。プロキシに関する「man curl」情報/ドキュメントを参照してください: --preproxy、--proxy-* (curl は多くのプロキシ設定をサポートしているため、ワイルドカード「*」です)。2. 「wget」を試してください。プロキシ オプションについてはドキュメントを確認してください。 


| 取得サービスの開始中に資格情報エラーが発生し、Data Infrastructure Insightsで取得ユニットのインストールに失敗しました (acq.log に表示されます)。 | これは、プロキシ資格情報に特殊文字が含まれていることが原因で発生する可能性があります。  AU をアンインストールし (_sudo cloudinsights-uninstall.sh_)、特殊文字を使用せずに再インストールします。 


| Linux: ライブラリが見つからない / ファイルが見つからない | Linux Acquisition Unit サーバー/VM に必要なライブラリがすべて揃っていることを確認します。たとえば、サーバーに _unzip_ ライブラリがインストールされている必要があります。  _unzip_ ライブラリをインストールするには、Acquisition Unit インストール スクリプトを実行する前に、コマンド _*sudo yum install unzip*_ を実行します。 


| 権限の問題 | _sudo_権限を持つユーザーとしてログインしていることを確認してください 


| 取得が実行されていません: | /opt/netapp/cloudinsights/acq/logs から acq.log を収集します (Linux) 取得サービスを再起動します: sudo cloudinsights-service.sh restart acquisition 


| データ収集の問題: | 「エラーレポートを送信」ボタンをクリックして、データコレクターのランディングページからエラーレポートを送信します。 


| ステータス: ハートビート失敗 | Acquisition Unit (AU) は、リースを更新するために、60 秒ごとにData Infrastructure Insightsにハートビートを送信します。ネットワークの問題または応答しないData Infrastructure Insights が原因でハートビート呼び出しが失敗した場合、AU のリース時間は更新されません。 AU のリースの期限が切れると、 Data Infrastructure Insights に「ハートビート失敗」というステータスが表示されます。トラブルシューティングの手順: Acquisition Unit サーバーと CloudInsights 間のネットワーク接続を確認します。 Acquisition Unit サービスが実行されているかどうかを確認します。サービスが実行されていない場合は、サービスを開始します。取得ユニット ログ (/var/log/netapp/cloudinsights/acq/acq.log) をチェックして、エラーがあるかどうかを確認します。 


| 「ハートビートエラー」というメッセージが表示されます | このエラーは、ネットワークの中断により、Acquisition Unit とData Infrastructure Insights環境間の通信が 1 分以上中断された場合に発生する可能性があります。  AU とData Infrastructure Insights間の接続が安定しておりアクティブであることを確認します。 


| 取得ユニットを再インストールすると、「ValueError: File context for /opt/netapp/cloudinsights(/.*)? already defined」というメッセージが表示されます。 | SELinux搭載のシステムでは、このエラーメッセージは `cloudinsights-uninstall.sh -p`が実行され、取得ユニットが再インストールされます。コマンドを実行する `semanage fcontext -d -t usr_t "/opt/netapp/cloudinsights(/.*)?"`問題を修正し、メッセージを削除する必要があります。 
|===


== プロキシとファイアウォールに関する考慮事項

組織でインターネット アクセスにプロキシの使用が必要な場合は、組織のプロキシの動作を理解し、 Data Infrastructure Insightsが機能するための特定の例外を探す必要がある場合があります。次の事項に注意してください。

* まず、組織ではデフォルトでアクセスをブロックし、例外的に特定の Web サイト/ドメインへのアクセスのみを許可していますか? その場合は、次のドメインを例外リストに追加する必要があります。
+
 *.cloudinsights.netapp.com
+
Data Infrastructure Insights取得ユニット、および Web ブラウザーでのData Infrastructure Insightsとのやり取りはすべて、そのドメイン名を持つホストに送信されます。

* 2 番目に、一部のプロキシは、 NetAppから生成されていないデジタル証明書を使用してData Infrastructure Insights Web サイトになりすまして TLS/SSL 検査を実行しようとします。Data Infrastructure Insights取得ユニットのセキュリティ モデルは、これらのテクノロジと根本的に互換性がありません。また、 Data Infrastructure Insights Acquisition Unit がData Infrastructure Insightsに正常にログインしてデータ検出を容易にするには、上記のドメイン名をこの機能から除外する必要があります。


トラフィック検査用にプロキシが設定されている場合は、プロキシ構成の例外リストにData Infrastructure Insights環境を追加する必要があります。この例外リストの形式と設定は、プロキシ環境とツールによって異なりますが、一般的には、AU がこれらのサーバーと適切に通信できるようにするには、 Data Infrastructure Insightsサーバーの URL をこの例外リストに追加する必要があります。

これを行う最も簡単な方法は、Data Infrastructure Insightsドメイン自体を例外リストに追加することです。

 *.cloudinsights.netapp.com
プロキシがトラフィック検査用に設定されていない場合は、例外リストが必要になる場合と、必要でない場合があります。  Data Infrastructure Insights を例外リストに追加する必要があるかどうか不明な場合、またはプロキシやファイアウォールの構成によりData Infrastructure Insightsのインストールや実行に問題がある場合は、プロキシ管理チームに問い合わせて、プロキシの SSL インターセプトの処理を設定してください。



=== プロキシエンドポイントの表示

オンボーディング中にデータ コレクターを選択するときに [*プロキシ設定*] リンクをクリックするか、[*ヘルプ > サポート*] ページの [_プロキシ設定_] の下のリンクをクリックすると、プロキシ エンドポイントを表示できます。次のような表が表示されます。環境に Workload Security がある場合は、設定されたエンドポイント URL もこのリストに表示されます。

image:ProxyEndpoints_NewTable.png["プロキシエンドポイントテーブル"]



== リソース

追加のトラブルシューティングのヒントについては、link:https://kb.netapp.com/Cloud/ncds/nds/dii/dii_kbs["NetAppナレッジベース"] (サポートへのサインインが必要です)。

追加のサポート情報は、Data Infrastructure Insightsから入手できます。link:concept_requesting_support.html["サポート"]ページ。
