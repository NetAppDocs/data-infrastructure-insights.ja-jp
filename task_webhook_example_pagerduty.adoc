---
sidebar: sidebar 
permalink: task_webhook_example_pagerduty.html 
keywords: webhook, notification, PagerDuty, integration 
summary: Pagerduty のパフォーマンスまたは在庫しきい値をアラートする Webhook を作成します。 
---
= PagerDuty の Webhook の例
:hardbreaks:
:allow-uri-read: 


[role="lead"]
Webhook を使用すると、ユーザーはカスタマイズされた Webhook チャネルを使用してさまざまなアプリケーションにアラート通知を送信できます。このページでは、PagerDuty の Webhook を設定する例を示します。


NOTE: このページはサードパーティの指示を参照しており、変更される可能性があります。参照link:https://support.pagerduty.com/docs/services-and-integrations["PagerDutyのドキュメント"]最新情報についてはこちらをご覧ください。



== PagerDutyのセットアップ:

. PagerDutyで*サービス>サービスディレクトリ*に移動し、*+新しいサービス*ボタンをクリックします。
. _名前_を入力し、[_API を直接使用_] を選択します。  _サービスの追加_をクリックします。
+
image:Webhooks_PagerDutyScreen1.png["Pagerduty 画面"]

. *統合キー*を表示するには、[_統合_] タブをクリックします。以下のData Infrastructure Insights Webhook を作成するときに、このキーが必要になります。


. アラートを表示するには、「*インシデント*」または「*サービス*」に移動します。
+
image:Webhooks_PagerDutyScreen2.png["Pagerduty スクリーン"]





== Data Infrastructure Insights Webhook を作成します。

. Data Infrastructure Insightsで、*管理 > 通知* に移動し、*Webhooks* タブを選択します。新しい Webhook を作成するには、[+Webhook] をクリックします。
. Webhook に「PagerDuty Trigger」などの意味のある名前を付けます。この Webhook は、重大レベルおよび警告レベルのイベントに使用します。
. _テンプレート タイプ_ ドロップダウンで、*PagerDuty* を選択します。


. _routingKey_ という名前のカスタム パラメータ シークレットを作成し、その値を上記の PagerDuty _Integration Key_ 値に設定します。
+
image:Webhooks_Custom_Secret_Routing_Key.png["ルーティングキーの設定"]



これらの手順を繰り返して、解決されたイベントの「PagerDuty Resolve」Webhook を作成します。



== PagerDuty からData Infrastructure Insightsへのフィールド マッピング

次の表と画像は、PagerDuty とData Infrastructure Insights間のフィールドのマッピングを示しています。

[cols="<,<"]
|===
| ページャーデューティ | Data Infrastructure Insights 


| アラートキー | Alert ID 


| ソース | トリガーオン 


| コンポーネント | メトリック名 


| グループ | オブジェクト タイプ 


| クラス | モニター名 
|===
image:Webhooks-PagerDuty_Fields.png["CI の PagerDuty フィールド"]



== Webhook経由の通知

Webhook経由でイベントを通知するには、Data Infrastructure Insightsで*アラート>モニター*に移動し、*+モニター*をクリックして新しいモニターを作成します。link:task_create_monitor.html["monitor"] 。

* メトリックを選択し、モニターの条件を定義します。
* [チーム通知の設定] の下で、*Webhook* 配信方法を選択します。
* 重大レベルおよび警告レベルのイベントには、「PagerDuty トリガー」Webhook を選択します。
* 解決されたイベントには「PagerDuty Resolve」を選択します。
+
image:Webhooks_Notifications.png["Webhook通知"]




NOTE: PagerDuty はトリガー イベントを解決済みイベントとは異なる方法で処理するため、トリガー イベントと解決済みイベントに別々の通知を設定することがベスト プラクティスです。
