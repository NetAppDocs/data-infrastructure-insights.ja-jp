---
sidebar: sidebar 
permalink: ws_notifications_using_webhooks.html 
keywords: alert, webhook, notification 
summary: ワークロード セキュリティ アラート通知用の Webhook を作成します。 
---
= Webhookを使用したワークロードセキュリティ通知
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Webhook を使用すると、ユーザーはカスタマイズされた Webhook チャネルを使用して、さまざまなアプリケーションに重大なアラート通知や警告アラート通知を送信できます。

多くの商用アプリケーションは、Slack、PagerDuty、Teams、Discord など、標準の入力インターフェースとして Webhook をサポートしています。汎用的でカスタマイズ可能な Webhook チャネルをサポートすることで、Workload Security はこれらの配信チャネルの多くをサポートできます。 Webhook の設定に関する情報は、それぞれのアプリケーションの Web サイトで確認できます。例えば、Slackはlink:https://api.slack.com/messaging/webhooks["この便利なガイド"]。

複数の Webhook チャネルを作成し、各チャネルを異なる目的、個別のアプリケーション、異なる受信者などを対象にすることができます。

Webhookチャネルインスタンスは次の要素で構成されています

|===
| Name | 説明 


| URL | Webhook ターゲット URL（URL パラメータとともに http:// または https:// プレフィックスを含む） 


| 方法 | GET/POST - デフォルトはPOST 


| カスタムヘッダー | ここでカスタムヘッダーを指定します 


| メッセージ本文 | メッセージの本文をここに入力してください 


| デフォルトのアラートパラメータ | Webhookのデフォルトパラメータを一覧表示します 


| カスタムパラメータとシークレット | カスタムパラメータとシークレットを使用すると、固有のパラメータやパスワードなどの安全な要素を追加できます。 
|===


== Webhookの作成

Workload Security Webhook を作成するには、「管理」>「通知」に移動し、「Workload Security Webhooks」タブを選択します。次の画像は、Slack Webhook 作成画面のサンプルを示しています。

注意: Workload Security Webhook を作成および管理するには、ユーザーは Workload Security _Admin_ である必要があります。

image:ws_webhook_slack_example.png["Workload Security の webhook Slack の例、幅 = 500"]

* 各フィールドに適切な情報を入力し、「保存」をクリックします。
* 「Webhook のテスト」ボタンをクリックして接続をテストすることもできます。これにより、選択したメソッドに従って、定義された URL に「メッセージ本文」（置換なし）が送信されることに注意してください。
* SWS Webhook は、いくつかのデフォルト パラメータで構成されています。さらに、独自のカスタム パラメータまたはシークレットを作成することもできます。




== パラメーター: パラメーターとは何か、どのように使用するのか?

アラート パラメータは、アラートごとに設定される動的な値です。たとえば、_%%severity%%_ パラメータは、アラートの重大度タイプに置き換えられます。

「Test Webhook」ボタンをクリックしたときには置換は実行されないことに注意してください。テストでは、パラメータのプレースホルダー (_%%<param-name>%%_) を表示するペイロードが送信されますが、データに置き換えられることはありません。



=== カスタムパラメータとシークレット

このセクションでは、必要なカスタム パラメータやシークレットを追加できます。カスタム パラメータまたはシークレットは、URL またはメッセージ本文に含めることができます。シークレットを使用すると、ユーザーはパスワード、apiKey などの安全なカスタム パラメータを設定できます。

次のサンプル画像は、Webhook の作成時にカスタム パラメータがどのように使用されるかを示しています。

image:ws_webhook_parameters_example.png["パラメータ付きワークロード セキュリティ Webhook、幅 = 800"]



== ワークロード セキュリティ Webhook リスト ページ

Webhook リスト ページには、名前、作成者、作成日、ステータス、セキュリティ、最終報告のフィールドが表示されます。注: 「ステータス」列の値は、最後の Webhook トリガーの結果に基づいて変化し続けます。以下はステータス結果の例です。

|===


| ステータス | 説明 


| OK | 通知を正常に送信しました。 


| 403 | 禁止されています。 


| 404 | URLが見つかりません。 


| 400  a| 
要求の形式が正しくありません。メッセージ本文にエラーがある場合、このステータスが表示されることがあります。例:

* 形式が不適切な json。
* 予約済みのキーに無効な値を指定しています。たとえば、PagerDuty は「重大度」として、critical/warning/error/info のみを受け入れます。その他の結果の場合は、400 ステータスが返される可能性があります。
* アプリケーション固有の検証エラー。たとえば、Slack ではセクション内に最大 10 個のフィールドが許可されます。  10 個を超えると、400 ステータスになる可能性があります。




| 410 | リソースは利用できなくなりました 
|===
「最終報告」列には、Webhook が最後にトリガーされた時刻が示されます。

ウェブフック一覧ページから、ユーザーはウェブフックを編集/複製/削除することもできます。



== アラートポリシーでWebhook通知を構成する

アラート ポリシーに Webhook 通知を追加するには、「ワークロード セキュリティ」>「ポリシー」に移動し、既存のポリシーを選択するか、新しいポリシーを追加します。  _アクション_ セクション > _Webhook 通知_ ドロップダウンで、必要な Webhook を選択します。

image:ws_edit_attack_policy.png["攻撃ポリシーの編集ダイアログに Webhook ドロップダウンが表示され、幅は 500 です"]

Webhook 通知はポリシーに関連付けられています。攻撃 (RW/DD/WARN) が発生すると、設定されたアクション (スナップショットの取得/ユーザーのブロック) が実行され、関連する Webhook 通知がトリガーされます。

注: 電子メール通知はポリシーとは無関係であり、通常どおりトリガーされます。

* ポリシーが一時停止されている場合、Webhook 通知はトリガーされません。
* 複数の Webhook を 1 つのポリシーにアタッチできますが、ポリシーにアタッチする Webhook は 5 つ以下にすることをお勧めします。




=== ワークロードセキュリティWebhookの例

Webhooksのlink:ws_webhook_example_slack.html["スラック"]

Webhooksのlink:ws_webhook_example_pagerduty.html["ページャーデューティ"]Webhooksのlink:ws_webhook_example_teams.html["チーム"]Webhooksのlink:ws_webhook_example_discord.html["不和"]
