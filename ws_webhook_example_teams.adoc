---
sidebar: sidebar 
permalink: ws_webhook_example_teams.html 
keywords: webhook, notification, Microsoft, Teams, integration 
summary: Microsoft Teams のセキュリティに関するアラートを通知するための Workload Security Webhook を作成する 
---
= Microsoft Teams のワークロード セキュリティ Webhook の例
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Webhook を使用すると、ユーザーはカスタマイズされた Webhook チャネルを使用してさまざまなアプリケーションにアラート通知を送信できます。このページでは、Teams の Webhook を設定する例を示します。


NOTE: このページはサードパーティの指示を参照しており、変更される可能性があります。参照link:https://docs.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook["Teamsドキュメント"]最新情報についてはこちらをご覧ください。



== Teams のセットアップ:

. Teams でケバブを選択し、Incoming Webhook を検索します。
+
image:Webhooks_Teams_Create_Webhook.png["Teams での受信 Webhook"]

. *チームに追加 > チームを選択 > コネクタの設定*を選択します。
. Webhook URL をコピーします。これを Workload Security Webhook 設定に貼り付ける必要があります。




== ワークロード セキュリティ チームの Webhook を作成します。

. 「管理」>「通知」に移動し、「Workload Security Webhooks」タブを選択します。新しい Webhook を作成するには、[_+ Webhook_] を選択します。
. Webhook に意味のある名前を付けます。
. [_テンプレート タイプ_] ドロップダウンで、[*Teams*] を選択します。
+
image:ws_webhook_teams_example.png["ワークロード セキュリティ チームの Webhook の例"]

. 上記の URL を _URL_ フィールドに貼り付けます。




=== アダプティブカードテンプレートを使用してTeams通知を作成する手順

. メッセージ本文を次のテンプレートに置き換えます：
+
....
  {
  "type": "message",
  "attachments": [
    {
      "contentType": "application/vnd.microsoft.card.adaptive",
      "content": {
        "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
        "type": "AdaptiveCard",
        "version": "1.2",
        "body": [
          {
            "type": "TextBlock",
            "text": "%%severity%% Alert: %%synopsis%%",
            "wrap": true,
            "weight": "Bolder",
            "size": "Large"
          },
          {
            "type": "TextBlock",
            "text": "%%detected%%",
            "wrap": true,
            "isSubtle": true,
            "spacing": "Small"
          },
          {
            "type": "FactSet",
            "facts": [
              {
                "title": "User",
                "value": "%%userName%%"
              },
              {
                "title": "Attack/Abnormal Behavior",
                "value": "%%type%%"
              },
              {
                "title": "Action taken",
                "value": "%%actionTaken%%"
              },
              {
                "title": "Files encrypted",
                "value": "%%filesEncrypted%%"
              },
              {
                "title": "Encrypted files suffix",
                "value": "%%encryptedFilesSuffix%%"
              },
              {
                "title": "Files deleted",
                "value": "%%filesDeleted%%"
              },
              {
                "title": "Activity Change Rate",
                "value": "%%changePercentage%%"
              },
              {
                "title": "Severity",
                "value": "%%severity%%"
              },
              {
                "title": "Status",
                "value": "%%status%%"
              },
              {
                "title": "Notes",
                "value": "%%note%%"
              }
            ]
          }
        ],
        "actions": [
          {
            "type": "Action.OpenUrl",
            "title": "View Details",
            "url": "https://%%cloudInsightsHostname%%/%%alertDetailsPageUrl%%"
          }
        ]
      }
    }
  ]
}
....
. Power Automate Flows を使用している場合、URL 内のクエリパラメータはエンコードされた形式になります。入力する前に URL をデコードする必要があります。
. 「Webhook をテスト」をクリックして、エラーがないことを確認します。
. Webhook を保存します。




== Webhook経由の通知

Webhook 経由でイベントを通知するには、[_Workload Security_] > [ポリシー] に移動します。  _+攻撃ポリシー_または_+警告ポリシー_を選択します。

* 意味のあるポリシー名を入力します。
* 必要な攻撃タイプ、ポリシーを適用するデバイス、および必要なアクションを選択します。
* [_Webhooks Notifications_] ドロップダウンで、必要な Teams Webhook を選択します。ポリシーを保存します。


注: Webhook は、編集することで既存のポリシーに添付することもできます。

image:ws_add_attack_policy.png["Webhook を表示する攻撃ポリシー ダイアログを追加する"]
